/**
 * Pusdokkes Framework Bridge
 * Seamless integration with Tailwind CSS, Bootstrap, and existing frameworks
 * Safe overlay mode - visual-only properties, no layout disruption
 * 
 * Bridge Features:
 * - Tailwind CSS class mapping
 * - Bootstrap component styling  
 * - Laravel Blade component theming
 * - Custom component bridging
 * - Framework-agnostic selectors
 */

@layer pd.bridge;

/* =========================
   GLOBAL FRAMEWORK BRIDGE
   ========================= */
@layer pd.bridge {
  
  /* ===== ROOT & BODY THEMING ===== */
  html[data-pd-safe] {
    background-color: var(--pd-background);
    color: var(--pd-text-primary);
    font-family: var(--pd-font-sans);
    color-scheme: light dark;
    transition: background-color var(--pd-transition-input), color var(--pd-transition-input);
  }

  html[data-pd-safe] body {
    background-color: var(--pd-background);
    color: var(--pd-text-primary);
    transition: background-color var(--pd-transition-input), color var(--pd-transition-input);
  }

  /* =========================
     TAILWIND CSS MAPPINGS
     ========================= */
  
  /* ===== BACKGROUND COLORS ===== */
  html[data-pd-safe] .bg-white { background-color: var(--pd-surface) !important; }
  html[data-pd-safe] .bg-gray-50 { background-color: var(--pd-background) !important; }
  html[data-pd-safe] .bg-gray-100 { background-color: var(--pd-surface-variant) !important; }
  html[data-pd-safe] .bg-gray-200 { background-color: var(--pd-border) !important; }
  html[data-pd-safe] .bg-gray-800 { background-color: var(--pd-surface-elevated) !important; }
  html[data-pd-safe] .bg-gray-900 { background-color: var(--pd-background) !important; }
  
  html[data-pd-safe] .bg-blue-50 { background-color: var(--pd-blue-50) !important; }
  html[data-pd-safe] .bg-blue-100 { background-color: var(--pd-blue-100) !important; }
  html[data-pd-safe] .bg-blue-500 { background-color: var(--pd-primary) !important; color: var(--pd-on-primary) !important; }
  html[data-pd-safe] .bg-blue-600 { background-color: var(--pd-primary) !important; color: var(--pd-on-primary) !important; }
  html[data-pd-safe] .bg-blue-700 { background-color: var(--pd-primary-hover) !important; color: var(--pd-on-primary) !important; }
  
  html[data-pd-safe] .bg-green-50 { background-color: var(--pd-success-bg) !important; }
  html[data-pd-safe] .bg-green-500 { background-color: var(--pd-success) !important; color: white !important; }
  html[data-pd-safe] .bg-green-600 { background-color: var(--pd-success) !important; color: white !important; }
  
  html[data-pd-safe] .bg-yellow-50 { background-color: var(--pd-warning-bg) !important; }
  html[data-pd-safe] .bg-yellow-500 { background-color: var(--pd-warning) !important; color: white !important; }
  html[data-pd-safe] .bg-orange-500 { background-color: var(--pd-warning) !important; color: white !important; }
  
  html[data-pd-safe] .bg-red-50 { background-color: var(--pd-error-bg) !important; }
  html[data-pd-safe] .bg-red-500 { background-color: var(--pd-error) !important; color: white !important; }
  html[data-pd-safe] .bg-red-600 { background-color: var(--pd-error) !important; color: white !important; }
  
  /* ===== TEXT COLORS ===== */
  html[data-pd-safe] .text-gray-900 { color: var(--pd-text-primary) !important; }
  html[data-pd-safe] .text-gray-800 { color: var(--pd-text-primary) !important; }
  html[data-pd-safe] .text-gray-700 { color: var(--pd-text-primary) !important; }
  html[data-pd-safe] .text-gray-600 { color: var(--pd-text-secondary) !important; }
  html[data-pd-safe] .text-gray-500 { color: var(--pd-text-muted) !important; }
  html[data-pd-safe] .text-gray-400 { color: var(--pd-text-disabled) !important; }
  
  html[data-pd-safe] .text-blue-600 { color: var(--pd-primary) !important; }
  html[data-pd-safe] .text-blue-500 { color: var(--pd-primary) !important; }
  html[data-pd-safe] .text-indigo-600 { color: var(--pd-secondary) !important; }
  html[data-pd-safe] .text-green-600 { color: var(--pd-success) !important; }
  html[data-pd-safe] .text-yellow-600 { color: var(--pd-warning) !important; }
  html[data-pd-safe] .text-red-600 { color: var(--pd-error) !important; }
  html[data-pd-safe] .text-white { color: var(--pd-text-inverse) !important; }
  
  /* ===== BORDER COLORS ===== */
  html[data-pd-safe] .border-gray-200 { border-color: var(--pd-border) !important; }
  html[data-pd-safe] .border-gray-300 { border-color: var(--pd-border-strong) !important; }
  html[data-pd-safe] .border-blue-500 { border-color: var(--pd-primary) !important; }
  html[data-pd-safe] .border-green-500 { border-color: var(--pd-success) !important; }
  html[data-pd-safe] .border-red-500 { border-color: var(--pd-error) !important; }
  
  /* ===== SHADOWS ===== */
  html[data-pd-safe] .shadow-sm { box-shadow: var(--pd-elevation-1) !important; }
  html[data-pd-safe] .shadow { box-shadow: var(--pd-elevation-2) !important; }
  html[data-pd-safe] .shadow-md { box-shadow: var(--pd-elevation-3) !important; }
  html[data-pd-safe] .shadow-lg { box-shadow: var(--pd-elevation-4) !important; }
  html[data-pd-safe] .shadow-xl { box-shadow: var(--pd-elevation-5) !important; }
  html[data-pd-safe] .shadow-none { box-shadow: none !important; }
  
  /* ===== ROUNDED CORNERS ===== */
  html[data-pd-safe] .rounded-sm { border-radius: var(--pd-radius-sm) !important; }
  html[data-pd-safe] .rounded { border-radius: var(--pd-radius-base) !important; }
  html[data-pd-safe] .rounded-md { border-radius: var(--pd-radius-md) !important; }
  html[data-pd-safe] .rounded-lg { border-radius: var(--pd-radius-lg) !important; }
  html[data-pd-safe] .rounded-xl { border-radius: var(--pd-radius-xl) !important; }
  html[data-pd-safe] .rounded-full { border-radius: var(--pd-radius-full) !important; }

  /* =========================
     BOOTSTRAP MAPPINGS
     ========================= */
  
  /* ===== BOOTSTRAP BUTTONS ===== */
  html[data-pd-safe] .btn {
    border-radius: var(--pd-radius-button);
    font-weight: var(--pd-font-medium);
    transition: all var(--pd-transition-button);
    box-shadow: var(--pd-elevation-1);
  }
  
  html[data-pd-safe] .btn:hover:not(:disabled) {
    box-shadow: var(--pd-elevation-2);
  }
  
  html[data-pd-safe] .btn:focus {
    outline: 2px solid var(--pd-primary);
    outline-offset: 2px;
  }
  
  html[data-pd-safe] .btn-primary {
    background-color: var(--pd-primary);
    border-color: var(--pd-primary);
    color: var(--pd-on-primary);
  }
  
  html[data-pd-safe] .btn-primary:hover:not(:disabled) {
    background-color: var(--pd-primary-hover);
    border-color: var(--pd-primary-hover);
  }
  
  html[data-pd-safe] .btn-secondary {
    background-color: var(--pd-secondary);
    border-color: var(--pd-secondary);
    color: var(--pd-on-secondary);
  }
  
  html[data-pd-safe] .btn-success {
    background-color: var(--pd-success);
    border-color: var(--pd-success);
    color: white;
  }
  
  html[data-pd-safe] .btn-warning {
    background-color: var(--pd-warning);
    border-color: var(--pd-warning);
    color: white;
  }
  
  html[data-pd-safe] .btn-danger {
    background-color: var(--pd-error);
    border-color: var(--pd-error);
    color: white;
  }
  
  html[data-pd-safe] .btn-outline-primary {
    color: var(--pd-primary);
    border-color: var(--pd-primary);
    background-color: transparent;
  }
  
  html[data-pd-safe] .btn-outline-primary:hover:not(:disabled) {
    background-color: var(--pd-primary);
    color: var(--pd-on-primary);
  }
  
  /* ===== BOOTSTRAP CARDS ===== */
  html[data-pd-safe] .card {
    background-color: var(--pd-surface);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-card);
    box-shadow: var(--pd-elevation-1);
    transition: box-shadow var(--pd-transition-input);
  }
  
  html[data-pd-safe] .card:hover {
    box-shadow: var(--pd-elevation-2);
  }
  
  html[data-pd-safe] .card-header {
    background-color: var(--pd-surface-variant);
    border-bottom: var(--pd-border-width-1) solid var(--pd-border);
  }
  
  html[data-pd-safe] .card-footer {
    background-color: var(--pd-surface-variant);
    border-top: var(--pd-border-width-1) solid var(--pd-border);
  }
  
  /* ===== BOOTSTRAP ALERTS ===== */
  html[data-pd-safe] .alert {
    border-radius: var(--pd-radius-md);
    border-width: var(--pd-border-width-1);
  }
  
  html[data-pd-safe] .alert-primary {
    color: var(--pd-primary);
    background-color: color-mix(in oklab, var(--pd-primary), var(--pd-background) 85%);
    border-color: color-mix(in oklab, var(--pd-primary), transparent 70%);
  }
  
  html[data-pd-safe] .alert-success {
    color: var(--pd-success-text);
    background-color: var(--pd-success-bg);
    border-color: var(--pd-success-border);
  }
  
  html[data-pd-safe] .alert-warning {
    color: var(--pd-warning-text);
    background-color: var(--pd-warning-bg);
    border-color: var(--pd-warning-border);
  }
  
  html[data-pd-safe] .alert-danger {
    color: var(--pd-error-text);
    background-color: var(--pd-error-bg);
    border-color: var(--pd-error-border);
  }
  
  /* ===== BOOTSTRAP FORMS ===== */
  html[data-pd-safe] .form-control {
    color: var(--pd-text-primary);
    background-color: var(--pd-surface);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-input);
    transition: all var(--pd-transition-input);
  }
  
  html[data-pd-safe] .form-control:focus {
    border-color: var(--pd-primary);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--pd-primary), transparent 85%);
    outline: none;
  }
  
  html[data-pd-safe] .form-control:disabled {
    background-color: var(--pd-surface-variant);
    color: var(--pd-text-disabled);
    border-color: var(--pd-border-subtle);
  }

  /* =========================
     LARAVEL BLADE COMPONENTS
     ========================= */
  
  /* ===== NAVIGATION ===== */
  html[data-pd-safe] nav,
  html[data-pd-safe] .navbar,
  html[data-pd-safe] header {
    background-color: var(--pd-surface);
    border-bottom: var(--pd-border-width-1) solid var(--pd-border);
    box-shadow: var(--pd-elevation-1);
    transition: all var(--pd-transition-input);
  }
  
  html[data-pd-safe] .navbar-brand {
    color: var(--pd-text-primary);
    font-weight: var(--pd-font-semibold);
  }
  
  html[data-pd-safe] .nav-link {
    color: var(--pd-text-secondary);
    border-radius: var(--pd-radius-base);
    transition: all var(--pd-transition-button);
  }
  
  html[data-pd-safe] .nav-link:hover {
    color: var(--pd-text-primary);
    background-color: color-mix(in oklab, var(--pd-primary), transparent 90%);
  }
  
  html[data-pd-safe] .nav-link.active {
    color: var(--pd-primary);
    background-color: color-mix(in oklab, var(--pd-primary), transparent 85%);
  }

  /* =========================
     FORM COMPONENTS
     ========================= */
  
  /* ===== FORM INPUTS ===== */
  html[data-pd-safe] input[type="text"],
  html[data-pd-safe] input[type="email"],
  html[data-pd-safe] input[type="password"],
  html[data-pd-safe] input[type="number"],
  html[data-pd-safe] input[type="date"],
  html[data-pd-safe] input[type="time"],
  html[data-pd-safe] input[type="datetime-local"],
  html[data-pd-safe] input[type="url"],
  html[data-pd-safe] input[type="tel"],
  html[data-pd-safe] input[type="search"],
  html[data-pd-safe] select,
  html[data-pd-safe] textarea {
    color: var(--pd-text-primary);
    background-color: var(--pd-surface);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-input);
    transition: all var(--pd-transition-input);
  }
  
  html[data-pd-safe] input:focus,
  html[data-pd-safe] select:focus,
  html[data-pd-safe] textarea:focus {
    border-color: var(--pd-primary);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--pd-primary), transparent 85%);
    outline: none;
  }
  
  html[data-pd-safe] input:invalid,
  html[data-pd-safe] input.is-invalid {
    border-color: var(--pd-error);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--pd-error), transparent 85%);
  }
  
  html[data-pd-safe] input:disabled,
  html[data-pd-safe] select:disabled,
  html[data-pd-safe] textarea:disabled {
    background-color: var(--pd-surface-variant);
    color: var(--pd-text-disabled);
    border-color: var(--pd-border-subtle);
    opacity: var(--pd-opacity-70);
  }
  
  /* ===== CHECKBOX & RADIO ===== */
  html[data-pd-safe] input[type="checkbox"],
  html[data-pd-safe] input[type="radio"] {
    accent-color: var(--pd-primary);
    border-radius: var(--pd-radius-xs);
  }
  
  html[data-pd-safe] input[type="checkbox"]:focus,
  html[data-pd-safe] input[type="radio"]:focus {
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--pd-primary), transparent 85%);
    outline: none;
  }

  /* =========================
     TABLE COMPONENTS
     ========================= */
  
  html[data-pd-safe] table {
    background-color: var(--pd-surface);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-lg);
    box-shadow: var(--pd-elevation-1);
    color: var(--pd-text-primary);
  }
  
  html[data-pd-safe] th {
    background-color: var(--pd-surface-variant);
    color: var(--pd-text-primary);
    font-weight: var(--pd-font-semibold);
    border-bottom: var(--pd-border-width-2) solid var(--pd-border);
  }
  
  html[data-pd-safe] td {
    border-bottom: var(--pd-border-width-1) solid var(--pd-border-subtle);
  }
  
  html[data-pd-safe] tbody tr:hover {
    background-color: color-mix(in oklab, var(--pd-primary), transparent 95%);
  }
  
  html[data-pd-safe] .table-striped tbody tr:nth-child(odd) {
    background-color: color-mix(in oklab, var(--pd-surface-variant), transparent 50%);
  }

  /* =========================
     MODAL & OVERLAY COMPONENTS
     ========================= */
  
  html[data-pd-safe] .modal-backdrop {
    background-color: var(--pd-overlay-backdrop);
    backdrop-filter: var(--pd-backdrop-blur-sm);
  }
  
  html[data-pd-safe] .modal-content,
  html[data-pd-safe] .modal-dialog {
    background-color: var(--pd-surface);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-modal);
    box-shadow: var(--pd-elevation-5);
    color: var(--pd-text-primary);
  }
  
  html[data-pd-safe] .modal-header {
    border-bottom: var(--pd-border-width-1) solid var(--pd-border);
  }
  
  html[data-pd-safe] .modal-footer {
    border-top: var(--pd-border-width-1) solid var(--pd-border);
    background-color: var(--pd-surface-variant);
  }
  
  html[data-pd-safe] .dropdown-menu {
    background-color: var(--pd-surface-elevated);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-lg);
    box-shadow: var(--pd-elevation-3);
    color: var(--pd-text-primary);
  }
  
  html[data-pd-safe] .dropdown-item {
    color: var(--pd-text-secondary);
    transition: all var(--pd-transition-button);
  }
  
  html[data-pd-safe] .dropdown-item:hover {
    color: var(--pd-text-primary);
    background-color: color-mix(in oklab, var(--pd-primary), transparent 90%);
  }

  /* =========================
     UTILITY COMPONENTS
     ========================= */
  
  /* ===== BADGES ===== */
  html[data-pd-safe] .badge {
    border-radius: var(--pd-radius-badge);
    font-size: var(--pd-text-xs);
    font-weight: var(--pd-font-medium);
  }
  
  html[data-pd-safe] .badge-primary {
    background-color: var(--pd-primary);
    color: var(--pd-on-primary);
  }
  
  html[data-pd-safe] .badge-success {
    background-color: var(--pd-success);
    color: white;
  }
  
  html[data-pd-safe] .badge-warning {
    background-color: var(--pd-warning);
    color: white;
  }
  
  html[data-pd-safe] .badge-danger {
    background-color: var(--pd-error);
    color: white;
  }
  
  /* ===== LINKS ===== */
  html[data-pd-safe] a {
    color: var(--pd-primary);
    text-decoration-thickness: 0.08em;
    text-underline-offset: 0.15em;
    transition: color var(--pd-transition-button);
  }
  
  html[data-pd-safe] a:hover {
    color: var(--pd-primary-hover);
    text-decoration: underline;
  }
  
  html[data-pd-safe] a:focus-visible {
    outline: 2px solid var(--pd-primary);
    outline-offset: 2px;
    border-radius: var(--pd-radius-xs);
  }
  
  /* ===== CODE & PRE ===== */
  html[data-pd-safe] code {
    background-color: var(--pd-surface-variant);
    color: var(--pd-text-primary);
    border-radius: var(--pd-radius-sm);
    font-family: var(--pd-font-mono);
  }
  
  html[data-pd-safe] pre {
    background-color: var(--pd-surface-variant);
    color: var(--pd-text-primary);
    border: var(--pd-border-width-1) solid var(--pd-border);
    border-radius: var(--pd-radius-md);
    box-shadow: var(--pd-elevation-1);
    font-family: var(--pd-font-mono);
  }
  
  /* ===== DIVIDERS ===== */
  html[data-pd-safe] hr,
  html[data-pd-safe] .divider {
    border-color: var(--pd-divider);
    opacity: var(--pd-opacity-60);
  }
  
  /* ===== SCROLLBARS ===== */
  html[data-pd-safe] ::-webkit-scrollbar {
    background: var(--pd-surface);
  }
  
  html[data-pd-safe] ::-webkit-scrollbar-track {
    background: var(--pd-surface-variant);
    border-radius: var(--pd-radius-sm);
  }
  
  html[data-pd-safe] ::-webkit-scrollbar-thumb {
    background: var(--pd-border-strong);
    border-radius: var(--pd-radius-sm);
    transition: background var(--pd-transition-fast);
  }
  
  html[data-pd-safe] ::-webkit-scrollbar-thumb:hover {
    background: var(--pd-text-muted);
  }
  
  /* ===== SELECTION ===== */
  html[data-pd-safe] ::selection {
    background-color: color-mix(in oklab, var(--pd-primary), transparent 80%);
    color: var(--pd-text-primary);
  }
  
  html[data-pd-safe] ::-moz-selection {
    background-color: color-mix(in oklab, var(--pd-primary), transparent 80%);
    color: var(--pd-text-primary);
  }

  /* =========================
     ACCESSIBILITY ENHANCEMENTS
     ========================= */
  
  /* ===== FOCUS MANAGEMENT ===== */
  html[data-pd-safe] :focus-visible {
    outline: 2px solid var(--pd-primary);
    outline-offset: 2px;
    border-radius: var(--pd-radius-xs);
  }
  
  html[data-pd-safe] .skip-link {
    background-color: var(--pd-primary);
    color: var(--pd-on-primary);
    border-radius: var(--pd-radius-md);
    font-weight: var(--pd-font-medium);
    box-shadow: var(--pd-elevation-3);
  }
  
  /* ===== REDUCED MOTION ===== */
  @media (prefers-reduced-motion: reduce) {
    html[data-pd-safe] * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
  
  /* ===== HIGH CONTRAST ===== */
  @media (prefers-contrast: high) {
    html[data-pd-safe] {
      --pd-border-width-1: 2px;
      --pd-elevation-1: none;
      --pd-elevation-2: none;
      --pd-elevation-3: none;
    }
    
    html[data-pd-safe] .btn,
    html[data-pd-safe] .form-control,
    html[data-pd-safe] .card {
      border-width: var(--pd-border-width-2);
    }
  }
}
